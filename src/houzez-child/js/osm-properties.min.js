jQuery(function(e){"use strict";if("undefined"!=typeof houzez_map_properties){if(e("#houzez-properties-map").length>0){var a,r,o=houzez_vars.is_mapbox,t=houzez_vars.api_mapbox,i=new Array,n=(new Array,1),s="",l=0,p=0,u="no",c=houzez_vars.admin_url+"admin-ajax.php",m=houzez_vars.user_id,h=houzez_vars.houzez_rtl,d=houzez_vars.processing_text,_=houzez_vars.not_found,z=houzez_vars.compare_url,v=houzez_vars.compare_add_icon,g=houzez_vars.add_compare_text,f=houzez_vars.compare_remove_icon,y=houzez_vars.remove_compare_text,x=houzez_vars.compare_limit,w=(houzez_vars.compare_page_not_found,houzez_vars.for_rent_price_slider),b=parseInt(houzez_vars.search_min_price_range),k=parseInt(houzez_vars.search_max_price_range),j=parseInt(houzez_vars.search_min_price_range_for_rent),I=parseInt(houzez_vars.search_max_price_range_for_rent),C=(parseInt(houzez_vars.get_min_price),parseInt(houzez_vars.get_max_price),houzez_vars.currency_position),T=houzez_vars.currency_symbol,Z=houzez_vars.thousands_separator,M=parseInt(houzez_vars.is_halfmap),S=parseFloat(houzez_vars.default_lat),O=parseFloat(houzez_vars.default_long),P=parseInt(houzez_vars.houzez_default_radius);if(h="yes"==h,"undefined"!=typeof houzez_map_options&&(houzez_map_options.clusterIcon,n=houzez_map_options.map_cluster_enable,houzez_map_options.clusterer_zoom,houzez_map_options.closeIcon,s=houzez_map_options.infoWindowPlac,houzez_map_options.marker_spiderfier,u=houzez_map_options.markerPricePins,houzez_map_options.map_type,houzez_map_options.googlemap_style),"mapbox"==o&&""!=t)var A=L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+t,{attribution:'© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>',tileSize:512,maxZoom:18,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"YOUR_MAPBOX_ACCESS_TOKEN"});else A=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});var B=e=>{if("number"==typeof e){for(var a=(e+="").split("."),r=a[0],o=a.length>1?"."+a[1]:"",t=/(\d+)(\d{3})/;t.test(r);)r=r.replace(t,"$1"+Z+"$2");return r+o}return e};e("#houzez-gmap-next").on("click",function(){!function(e){for(++l>i.length&&(l=1);!1===i[l-1].visible;)++l>i.length&&(l=1);e.getZoom()<15&&e.setZoom(15),e.setView(i[l-1].getLatLng()),i[l-1]._icon||i[l-1].__parent.spiderfy(),e.setZoom(20),l-1==0||l-1==i.length?setTimeout(function(){i[l-1].fire("click")},500):i[l-1].fire("click")}(a)}),e("#houzez-gmap-prev").on("click",function(){!function(e){for(--l<1&&(l=i.length);!1===i[l-1].visible;)--l>i.length&&(l=1);e.getZoom()<15&&e.setZoom(15),e.setView(i[l-1].getLatLng()),i[l-1]._icon||i[l-1].__parent.spiderfy(),e.setZoom(20),l-1==0||l==i.length?setTimeout(function(){i[l-1].fire("click")},500):i[l-1].fire("click")}(a)});var E=function(){for(var e=0;e<i.length;e++)a.removeLayer(i[e]);i=[],r&&a.removeLayer(r)},U=function(e){for(var a=[],r=0;r<e.length;r++)e[r].lat&&e[r].lng&&a.push([e[r].lat,e[r].lng]);return a},D=function(e,a){var o,t=U(e);1<t.length&&a.fitBounds(t),1==n&&(r=new L.MarkerClusterGroup({iconCreateFunction:function(e){var a='<div class="houzez-osm-cluster">'+e.getAllChildMarkers().length+"</div>";return L.divIcon({html:a,className:"mycluster",iconSize:L.point(47,47)})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0}));for(var l=0;l<e.length;l++)if(e[l].lat&&e[l].lng){var p=e[l],c=L.latLng(p.lat,p.lng),m={riseOnHover:!0};if(p.title&&(m.title=p.title),"yes"==u){var h='<div data-id="'+e[l].property_id+'" class="gm-marker gm-marker-color-'+e[l].term_id+'"><div class="gm-marker-price">'+e[l].pricePin+"</div></div>",d=L.divIcon({className:"someclass",iconSize:new L.Point(0,0),html:h});o=1==n?new L.Marker(c,{icon:d}):L.marker(c,{icon:d}).addTo(a)}else{if(p.marker){var _={iconUrl:p.marker,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};p.retinaMarker&&(_.iconRetinaUrl=p.retinaMarker),m.icon=L.icon(_)}o=1==n?new L.Marker(c,m):L.marker(c,m).addTo(a)}1==n&&r.addLayer(o);var z=document.createElement("div");z.className="map-info-window";var v="";v+='<div class="item-wrap">',v+='<div class="item-header">',e[l].thumbnail?v+='<a href="'+e[l].url+'"><img class="img-fluid" src="'+e[l].thumbnail+'" alt="'+e[l].title+'"/></a>':v+='<a href="'+e[l].url+'"><img class="img-fluid" src="'+s+'" alt="'+e[l].title+'"/></a>',v+="</div>",v+='<div class="item-body flex-grow-1">',v+='<h2 class="item-title">',v+='<a href="'+e[l].url+'">'+e[l].title+"</a>",v+="</h2>",v+='<ul class="list-unstyled item-info">',e[l].price&&(v+='<li class="item-price">'+e[l].price+"</li>"),e[l].property_type&&(v+='<li class="item-type">'+e[l].property_type+"</li>"),v+="</ul>",v+="</div>",v+="</div>",z.innerHTML=v,i.push(o),o.bindPopup(z)}1==n&&a.addLayer(r)};if(houzez_map_properties.length>0){var H=U(houzez_map_properties),N=L.latLng(S,O);1==H.length&&(N=L.latLng(H[0]));var R={dragging:!0,center:N,zoom:10,tap:!0};(a=L.map("houzez-properties-map",R)).scrollWheelZoom.disable(),1<H.length&&a.fitBounds(H),a.addLayer(A),document.getElementById("listing-mapzoomin")&&(K=a,e("#listing-mapzoomin").on("click",function(){var e=parseInt(K.getZoom(),10);console.log(e),++e>20&&(e=20),console.log("=="+e+" ++ "),K.setZoom(e)})),document.getElementById("listing-mapzoomout")&&function(a){e("#listing-mapzoomout").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),--e<0&&(e=0),console.log("=="+e+" -- "),a.setZoom(e)})}(a),D(houzez_map_properties,a)}else{var q={center:[S,O],zoom:10};(a=L.map("houzez-properties-map",q)).addLayer(A),a.scrollWheelZoom.disable()}var F=function(r){var o=e("#houzez_ajax_container"),t=e(".map-wrap"),i=e("#half-map-listing-area .page-title span"),n=e(".houzez-search-form-js"),s=e("#ajax_sort_properties").val(),l=e(".listing-view").data("layout");return e.ajax({type:"GET",dataType:"json",url:c,data:n.serialize()+"&action=houzez_half_map_listings&paged="+r+"&sortby="+s+"&item_layout="+l,beforeSend:function(){e(".houzez-map-loading").show(),o.empty().append('<div id="houzez-map-loading" class="houzez-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>'),t.append('<div id="houzez-map-loading" class="houzez-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(r){var t;return""!=r.query&&e('input[name="search_args"]').val(r.query),""!=r.search_uri&&e('input[name="search_URI"]').val(r.search_uri),e(".map-notfound").remove(),e(".search-no-results-found").remove(),e(".houzez-map-loading").hide(),!0===r.getProperties?(E(),D(r.properties,a),o.empty().html(r.propHtml),i.empty().html(r.total_results),V(),houzez_init_add_favorite(c,m),houzez_init_remove_favorite(c,m),houzez_listing_lightbox(c,d,h,m),t=houzezGetCookie("houzez_compare_listings"),add_to_compare(z,v,f,g,y,x,t,4),remove_from_compare(t,v,f,g,y),e('[data-toggle="tooltip"]').tooltip()):(E(),e("#houzez-properties-map").append('<div class="map-notfound">'+_+"</div>"),o.empty().html('<div class="search-no-results-found">'+_+"</div>"),i.empty().html(r.total_results)),!1},error:function(e,a,r){console.log(e.status),console.log(e.responseText),console.log(r)}}),!1},G=()=>{var a=e("form.houzez-search-filters-js"),r=a.attr("action"),o=a.find(":input").filter(function(a,r){if(""!=e(r).val()&&"search_geolocation"!=e(r).attr("name")&&"search_URI"!=e(r).attr("name")&&"search_args"!=e(r).attr("name")&&"houzez_save_search_ajax"!=e(r).attr("name"))return!0}).serialize();(e=>{window.history.pushState({houzezTheme:!0},"",e)})(r=-1!=r.indexOf("?")?r+"&"+o:r+"?"+o)},Q=function(e){E(),G(),F(e)},W=function(a,r){if(e(".price-range").slider({range:!0,min:a,max:r,values:[a,r],slide:function(a,r){if("after"==C)var o=B(r.values[0])+T,t=B(r.values[1])+T;else o=T+B(r.values[0]),t=T+B(r.values[1]);e(".min-price-range-hidden").val(r.values[0]),e(".max-price-range-hidden").val(r.values[1]),e(".min-price-range").text(o),e(".max-price-range").text(t)},stop:function(e,a){Q(p=0)}}),"after"==C)var o=B(e(".price-range").slider("values",0))+T,t=B(e(".price-range").slider("values",1))+T;else o=T+B(e(".price-range").slider("values",0)),t=T+B(e(".price-range").slider("values",1));e(".min-price-range").text(o),e(".max-price-range").text(t),e(".min-price-range-hidden").val(e(".price-range").slider("values",0)),e(".max-price-range-hidden").val(e(".price-range").slider("values",1))};if(e(".price-range").length>0&&1==M)e(".status-js").val()==w?W(j,I):W(b,k),e(".status-js").on("change",function(){e(this).val()==w?W(j,I):W(b,k)});e("#radius-range-slider").length>0&&($=P,e("#radius-range-slider").slider({value:$,min:0,max:100,step:1,value:e("#radius-range-value").data("default"),slide:function(a,r){e("#radius-range-text").html(r.value),e("#radius-range-value").val(r.value)},stop:function(a,r){e("#houzez-properties-map").length>0&&Q(p=0)}}),e("#radius-range-text").html(e("#radius-range-slider").slider("value")),e("#radius-range-value").val(e("#radius-range-slider").slider("value")));var V=function(){return e(".houzez_ajax_pagination a").on("click",function(a){a.preventDefault(),p=e(this).data("houzepagi"),Q(p)}),!1};V();e("#ajax_sort_properties").on("change",function(){Q(p=0)}),e("select.houzez_search_ajax, input.houzez_search_ajax").on("change",function(){Q(p=0)}),e(".btn-apply, .half-map-search-js-btn, #auto_complete_ajax").on("click",function(e){e.preventDefault(),Q(p=0)})}e("#houzez-gmap-full-osm").on("click",function(){var r=e(this);r.hasClass("active")?(r.removeClass("active"),r.parents(".map-wrap").removeClass("houzez-fullscreen-map")):(r.parents(".map-wrap").addClass("houzez-fullscreen-map"),r.addClass("active")),a.invalidateSize(),a.panTo(a.getCenter())}),e("#houzez-btn-map-view").on("click",function(r){r.preventDefault(),e("#half-map-listing-area, .listing-wrap").hide(),e("#map-view-wrap").show(),a.invalidateSize(),a.panTo(a.getCenter());var o=U(houzez_map_properties);1<o.length&&a.fitBounds(o)}),e("#houzez-btn-listing-view").on("click",function(a){a.preventDefault(),e("#map-view-wrap").hide(),e("#half-map-listing-area, .listing-wrap").show()}),e("input.search_location_js").length>0&&jQuery("input.search_location_js").autocomplete({source:function(e,a){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:e.term},function(e){e.length?a(e.map(function(e){return{label:e.display_name,latitude:e.lat,longitude:e.lon,value:e.display_name}})):a([{value:"",label:"there are no results"}])},"json")},select:function(a,r){if(e('input[name="lat"]').val(r.item.latitude),e('input[name="lng"]').val(r.item.longitude),M){Q(0)}}})}var $,K});